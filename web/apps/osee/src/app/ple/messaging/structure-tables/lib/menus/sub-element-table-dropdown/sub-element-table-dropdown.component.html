<!--
* Copyright (c) 2023 Boeing
*
* This program and the accompanying materials are made
* available under the terms of the Eclipse Public License 2.0
* which is available at https://www.eclipse.org/legal/epl-2.0/
*
* SPDX-License-Identifier: EPL-2.0
*
* Contributors:
*     Boeing - initial API and implementation
-->
@if (
	_branchType !== undefined &&
	_branchId !== undefined &&
	!element.autogenerated &&
	!element.interfaceElementArrayHeader
) {
	<a
		mat-menu-item
		[routerLink]="
			'/ple/messaging/' +
			_branchType +
			'/' +
			_branchId +
			'/type/' +
			element.platformType.id
		"
		queryParamsHandling="merge"
		><mat-icon>subdirectory_arrow_right</mat-icon>Open Platform Type</a
	>
	<a
		mat-menu-item
		target="_blank"
		[routerLink]="
			'/ple/messaging/' +
			_branchType +
			'/' +
			_branchId +
			'/type/' +
			element.platformType.id
		"
		queryParamsHandling="merge"
		><mat-icon class="tw-text-osee-blue-9">open_in_new</mat-icon>Open
		Platform Type in new tab</a
	>
	<mat-divider></mat-divider>
}
@if (
	(element.platformType.interfaceLogicalType | attributeToValue) ===
	'enumeration'
) {
	@if (element.platformType.id) {
		<button
			mat-menu-item
			(click)="openEnumDialog(element.platformType.id.toString())"
			data-cy="element-open-enum-btn">
			<mat-icon class="tw-text-osee-blue-9">toc</mat-icon>Open Enumeration
			Details
		</button>
	}
}
@if (!element.autogenerated) {
	<button
		mat-menu-item
		(click)="openDescriptionDialog(element)"
		data-cy="element-open-description-btn">
		<mat-icon class="tw-text-osee-blue-9">description</mat-icon>Open
		Description
	</button>
	<button
		mat-menu-item
		(click)="openNotesDialog(element)"
		data-cy="element-open-notes-btn">
		<mat-icon class="tw-text-osee-blue-9">notes</mat-icon>Open Notes
	</button>
	@if (
		element.platformType.interfaceLogicalType.value !== 'enumeration' &&
		!element.interfaceElementArrayHeader
	) {
		<button
			mat-menu-item
			(click)="openEnumLiteralDialog(element)"
			data-cy="element-open-enum-literal-btn">
			<mat-icon class="tw-text-osee-blue-9">notes</mat-icon>Open Enum
			Literals
		</button>
	}
	@if (editMode) {
		<button
			mat-menu-item
			(click)="openEditElementDialog(element)"
			data-cy="element-edit-btn">
			<mat-icon class="tw-text-osee-blue-9">edit</mat-icon>Edit Element
		</button>
	}
	<mat-divider></mat-divider>
}
@if ((getHeaderByName(header) | async)?.humanReadable; as headername) {
	@if (
		hasChanges(element) &&
		element.changes !== undefined &&
		isDiffableHeader(header) &&
		element.changes[header] !== undefined &&
		!element.autogenerated
	) {
		<button
			mat-menu-item
			(click)="
				hasChanges(element) &&
				element.changes !== undefined &&
				isDiffableHeader(header) &&
				element.changes[header] !== undefined
					? viewDiff($any(element.changes[header]), headername)
					: null
			"
			data-cy="element-diff-btn">
			<mat-icon class="tw-text-osee-yellow-10 dark:tw-text-osee-amber-9"
				>pageview</mat-icon
			>View Diff
		</button>
		<mat-divider></mat-divider>
	}
}
@if (
	editMode === true &&
	((hasChanges(element) && !element.deleted) || !hasChanges(element)) &&
	!element.autogenerated
) {
	<button
		mat-menu-item
		(click)="openAddElementDialog(structure, false, true, element.id)"
		data-cy="element-insert-after-btn">
		<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element after
	</button>
	<button
		mat-menu-item
		(click)="openAddElementDialog(structure, false, true, 'start')"
		data-cy="element-insert-top-btn">
		<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element at
		start
	</button>
	<button
		mat-menu-item
		(click)="openAddElementDialog(structure, false, true)"
		data-cy="element-insert-end-btn">
		<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element at end
	</button>
	@if (element.interfaceElementArrayHeader.value) {
		<button
			mat-menu-item
			(click)="openAddElementDialog(element, true, false)"
			data-cy="element-insert-end-btn">
			<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element to
			array
		</button>
	}
	<button
		mat-menu-item
		[matMenuTriggerFor]="copyMenu"
		[matMenuTriggerData]="{ copy: element }"
		data-cy="element-copy-btn">
		<mat-icon>content_copy</mat-icon>Copy
	</button>
	<mat-divider></mat-divider>
	<button
		mat-menu-item
		(click)="removeElement(element, structure)"
		data-cy="element-remove-btn">
		<mat-icon class="tw-text-osee-red-9">remove_circle_outline</mat-icon
		>Remove element from structure
	</button>
	<button
		mat-menu-item
		(click)="deleteElement(element)">
		<mat-icon
			class="tw-text-osee-red-9"
			data-cy="element-delete-btn"
			>delete_forever</mat-icon
		>Delete element globally
	</button>
}
@if (element.autogenerated) {
	<mat-label> No options available for autogenerated elements. </mat-label>
}
<mat-menu #copyMenu>
	<ng-template
		matMenuContent
		let-copy="copy">
		<button
			mat-menu-item
			(click)="
				openAddElementDialog(structure, false, false, element.id, copy)
			"
			data-cy="element-insert-after-btn">
			<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element
			after
		</button>
		<button
			mat-menu-item
			(click)="
				openAddElementDialog(structure, false, false, 'start', copy)
			"
			data-cy="element-insert-top-btn">
			<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element at
			start
		</button>
		<button
			mat-menu-item
			(click)="
				openAddElementDialog(structure, false, false, undefined, copy)
			"
			data-cy="element-insert-end-btn">
			<mat-icon class="tw-text-osee-green-9">add</mat-icon>Add element at
			end
		</button>
	</ng-template>
</mat-menu>
