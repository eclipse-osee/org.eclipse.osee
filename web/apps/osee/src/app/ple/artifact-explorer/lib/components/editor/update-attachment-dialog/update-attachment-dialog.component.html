<!--
/*********************************************************************
 * Copyright (c) 2025 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 **********************************************************************/
-->
<div mat-dialog-title>
	<h3 class="tw-font-semibold">Update attachment</h3>
</div>

<div
	mat-dialog-content
	class="tw-p-4">
	<!-- Current file info -->
	<div class="tw-mb-3 tw-text-sm tw-text-osee-neutral-60">
		Current file:
		<span class="tw-font-medium">{{ data.attachment.fileName }}</span>
		<span
			class="tw-text-xs tw-text-osee-neutral-50"
			*ngIf="data.attachment.sizeBytes as sz">
			({{ sz | bytes:0 }})
		</span>
	</div>

	<!-- Drag-and-drop area -->
	<div
		class="tw-rounded tw-border-2 tw-border-dashed tw-p-6 tw-text-center tw-transition-colors"
		[class.tw-border-blue-500]="dragActive()"
		[class.tw-bg-blue-50]="dragActive()"
		(dragover)="onDragOver($event)"
		(dragleave)="onDragLeave($event)"
		(drop)="onDrop($event)">
		<div class="tw-space-y-2">
			<div class="tw-font-medium tw-text-osee-neutral-60">
				Drag & drop a replacement file here
			</div>
			<div class="tw-text-sm tw-text-osee-neutral-60">or</div>

			<!-- Hidden file input -->
			<input
				#fileInput
				type="file"
				class="tw-hidden"
				[attr.accept]="data?.accept || null"
				(change)="onFileInputChange($event)" />

			<!-- Material raised button triggers hidden input -->
			<button
				mat-raised-button
				type="button"
				(click)="fileInput.click()"
				class="tw-rounded tw-bg-osee-blue-6 tw-text-osee-neutral-100 hover:tw-bg-osee-blue-7"
				aria-label="Choose file">
				Choose file
			</button>
		</div>
	</div>

	<!-- Selected file preview -->
	<div class="tw-mt-4">
		<div
			class="tw-text-sm tw-text-osee-neutral-60"
			*ngIf="!file()">
			No file selected.
		</div>

		<div
			class="tw-flex tw-items-center tw-justify-between tw-p-2"
			*ngIf="file() as f">
			<div class="tw-flex tw-items-center tw-gap-3">
				<div>{{ f.name }}</div>
				<div class="tw-text-xs tw-text-osee-neutral-50">
					({{ f.size | bytes:0}})
				</div>
			</div>
			<button
				mat-button
				class="tw-ml-2 tw-rounded tw-bg-osee-red-24 tw-px-2 tw-py-1 tw-text-osee-neutral-100 hover:tw-bg-osee-red-21"
				type="button"
				(click)="removeFile()">
				Remove
			</button>
		</div>
	</div>
</div>

<div
	mat-dialog-actions
	class="tw-flex tw-justify-end tw-gap-2 tw-px-4 tw-pb-4">
	<button
		mat-button
		class="tw-rounded tw-bg-osee-neutral-35 tw-px-3 tw-py-2 tw-text-osee-neutral-100 hover:tw-bg-osee-neutral-50"
		type="button"
		(click)="onCancel()">
		Cancel
	</button>
	<button
		mat-button
		class="tw-rounded tw-bg-primary tw-px-3 tw-py-2 tw-text-background-background hover:tw-bg-osee-neutral-87 disabled:tw-opacity-50"
		color="primary"
		type="button"
		[disabled]="!file()"
		(click)="submit()">
		Update
	</button>
</div>
