<!--
 * Copyright (c) 2021 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
<h1
	mat-dialog-title
	*ngIf="(editable | async) === 'true'">
	Editing Feature: {{ data.feature.name }}
</h1>
<h1
	mat-dialog-title
	*ngIf="(editable | async) === 'false'">
	Feature Details
</h1>
<div mat-dialog-content>
	<div *ngIf="(editable | async) === 'true'">
		<mat-form-field class="tw-w-full tw-text-lg">
			<mat-label>Description</mat-label>
			<input
				matInput
				type="text"
				[(ngModel)]="data.feature.description"
				#input
				[disabled]="(editable | async) === 'false'"
				data-cy="field-description"
				[attr.data-cy-value]="
					'field-description-' + data.feature.description
				" />
		</mat-form-field>
		<br />
		<mat-form-field class="tw-w-full tw-text-lg">
			<mat-label>Select a Value Type</mat-label>
			<mat-select
				[(ngModel)]="data.feature.valueType"
				[disabled]="(editable | async) === 'false'"
				data-cy="field-valueType"
				[attr.data-cy-value]="
					'field-valueType-' + data.feature.valueType
				">
				<mat-option
					*ngFor="let type of valueTypes | async"
					[value]="type"
					[attr.data-cy]="'option-' + type">
					{{ type }}
				</mat-option>
			</mat-select>
		</mat-form-field>
		<br />
		<mat-slide-toggle
			[(ngModel)]="data.feature.multiValued"
			labelPosition="before"
			(change)="selectMultiValued()"
			[disabled]="(editable | async) === 'false'"
			class="tw-text-lg"
			data-cy="field-multiValued"
			[attr.data-cy-value]="
				'field-multiValued-' + data.feature.multiValued
			">
			Multi-Valued
		</mat-slide-toggle>
		<br />
		<mat-form-field
			*ngFor="
				let value of data.feature.values;
				index as i;
				trackBy: valueTracker
			"
			class="tw-w-full tw-text-lg">
			<mat-label>Value</mat-label>
			<input
				matInput
				type="text"
				#input
				[(ngModel)]="data.feature.values[i]"
				(keyup)="data.feature.setValueStr()"
				[disabled]="(editable | async) === 'false'"
				[attr.data-cy]="'field-value-' + i"
				[attr.data-cy-value]="
					'field-value-' + data.feature.values[i]
				" />
		</mat-form-field>
		<br />
		<div *ngIf="(editable | async) === 'true'">
			<button
				mat-stroked-button
				(click)="increaseValueArray()"
				[disabled]="(editable | async) === 'false'"
				class="tw-w-full tw-text-lg"
				data-cy="add-value-btn">
				Add a Value
			</button>
			<br />
		</div>
		<mat-form-field class="tw-w-full tw-text-lg">
			<mat-label>Select a Default Value</mat-label>
			<mat-select
				[(ngModel)]="data.feature.defaultValue"
				[disabled]="(editable | async) === 'false'"
				data-cy="field-defaultValue"
				[attr.data-cy-value]="
					'field-defaultValue-' + data.feature.defaultValue
				">
				<mat-option
					*ngFor="let value of data.feature.values"
					[value]="value"
					[attr.data-cy]="'option-' + value">
					{{ value }}
				</mat-option>
			</mat-select>
		</mat-form-field>
		<br />
		<div>
			<mat-label
				class="tw-text-lg"
				data-cy="product-types-selection"
				>Select Product Types</mat-label
			>
			<mat-selection-list
				[(ngModel)]="data.feature.productApplicabilities"
				color="primary"
				class="tw-text-lg">
				<mat-list-option
					*ngFor="let type of productApplicabilities | async"
					[value]="type.name"
					[attr.data-cy]="
						'field-product-type-' +
						type.name +
						'-' +
						data.feature.productApplicabilities.includes(type.name)
					">
					{{ type.name }}
				</mat-list-option>
			</mat-selection-list>
		</div>
	</div>
	<div *ngIf="(editable | async) === 'false'">
		<div>
			<mat-label
				data-cy="field-name"
				[attr.data-cy-value]="'field-name-' + data.feature.name"
				><b>Title:</b></mat-label
			>
			{{ data.feature.name }}
		</div>
		<br />
		<div>
			<mat-label
				data-cy="field-description"
				[attr.data-cy-value]="
					'field-description-' + data.feature.description
				"
				><b>Description:</b></mat-label
			>
			{{ data.feature.description }}
		</div>
		<br />
		<div>
			<mat-label
				[attr.data-cy-value]="
					'field-valueType-' + data.feature.valueType
				"
				><b>Value Type:</b></mat-label
			>
			{{ data.feature.valueType }}
		</div>
		<br />
		<div>
			<mat-label
				data-cy="field-multiValued"
				[attr.data-cy-value]="
					'field-multiValued-' + data.feature.multiValued
				"
				><b>Multi-Valued:</b></mat-label
			>
			{{ data.feature.multiValued }}
		</div>
		<br />
		<div>
			<mat-label><b>Values:</b></mat-label>
			<div
				*ngFor="
					let value of data.feature.values;
					index as i;
					trackBy: valueTracker
				"
				[attr.data-cy]="'field-value-' + i"
				[attr.data-cy-value]="'field-value-' + data.feature.values[i]">
				{{ value }}
			</div>
		</div>
		<br />
		<div>
			<mat-label
				data-cy="field-defaultValue"
				[attr.data-cy-value]="
					'field-defaultValue-' + data.feature.defaultValue
				"
				><b>Default Value:</b></mat-label
			>
			{{ data.feature.defaultValue }}
		</div>
		<br />
		<div>
			<mat-label data-cy="product-types-selection"
				><b>Product Types:</b></mat-label
			>
			<div
				*ngFor="
					let value of data.feature.productApplicabilities;
					index as i;
					trackBy: valueTracker
				"
				[attr.data-cy]="'field-product-type-' + value">
				{{ value }}
			</div>
			<div *ngIf="data.feature.productApplicabilities.length === 0">
				None
			</div>
		</div>
	</div>
</div>
<div mat-dialog-actions>
	<button
		mat-button
		(click)="onNoClick()">
		<div
			*ngIf="(editable | async) === 'true'"
			data-cy="cancel-btn">
			Cancel
		</div>
		<div
			*ngIf="(editable | async) === 'false'"
			data-cy="ok-btn">
			Ok
		</div>
	</button>
	<div *ngIf="(editable | async) === 'true'">
		<button
			mat-button
			[mat-dialog-close]="data"
			cdkFocusInitial
			data-cy="submit-btn">
			Ok
		</button>
	</div>
</div>
