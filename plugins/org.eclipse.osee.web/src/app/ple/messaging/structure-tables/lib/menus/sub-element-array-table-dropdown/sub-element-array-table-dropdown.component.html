<!--
 * Copyright (c) 2023 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
<ng-container
	*ngIf="
		_branchType !== undefined &&
		_branchId !== undefined &&
		!element.autogenerated
	">
	<a
		mat-menu-item
		[routerLink]="
			'/ple/messaging/' +
			_branchType +
			'/' +
			_branchId +
			'/type/' +
			element.platformType.id
		"
		queryParamsHandling="merge"
		><mat-icon>subdirectory_arrow_right</mat-icon>Open Platform Type</a
	>
	<a
		mat-menu-item
		target="_blank"
		[routerLink]="
			'/ple/messaging/' +
			_branchType +
			'/' +
			_branchId +
			'/type/' +
			element.platformType.id
		"
		queryParamsHandling="merge"
		><mat-icon color="primary">open_in_new</mat-icon>Open Platform Type in
		new tab</a
	>
	<mat-divider></mat-divider>
</ng-container>
<ng-container *ngIf="element.logicalType === 'enumeration'">
	<ng-container *ngIf="element.platformType.id">
		<button
			mat-menu-item
			(click)="openEnumDialog(element.platformType.id.toString())"
			data-cy="element-open-enum-btn">
			<mat-icon color="primary">toc</mat-icon>Open Enumeration Details
		</button>
	</ng-container>
</ng-container>
<ng-container *ngIf="!element.autogenerated">
	<button
		mat-menu-item
		(click)="openDescriptionDialog(element.description, element.id)"
		data-cy="element-open-description-btn">
		<mat-icon color="primary">description</mat-icon>Open Description
	</button>
	<button
		mat-menu-item
		(click)="openNotesDialog(element.notes, element.id)"
		data-cy="element-open-notes-btn">
		<mat-icon color="primary">notes</mat-icon>Open Notes
	</button>
	<ng-container *ngIf="element.logicalType !== 'enumeration'">
		<button
			mat-menu-item
			(click)="openEnumLiteralDialog(element.enumLiteral, element.id)"
			data-cy="element-open-enum-literal-btn">
			<mat-icon color="primary">notes</mat-icon>Open Enum Literals
		</button>
	</ng-container>
	<ng-container *ngIf="editMode">
		<button
			mat-menu-item
			(click)="openEditElementDialog(element)"
			data-cy="element-edit-btn">
			<mat-icon color="primary">edit</mat-icon>Edit Element
		</button>
	</ng-container>
	<mat-divider></mat-divider>
</ng-container>
<ng-container
	*ngIf="(getHeaderByName(header) | async)?.humanReadable as headername">
	<ng-container
		*ngIf="
			hasChanges(element) &&
			element.changes !== undefined &&
			element.changes[header] !== undefined &&
			!element.autogenerated
		">
		<button
			mat-menu-item
			(click)="
				hasChanges(element) &&
				element.changes !== undefined &&
				element.changes[header] !== undefined
					? viewDiff($any(element.changes[header]), headername)
					: null
			"
			data-cy="element-diff-btn">
			<mat-icon color="accent">pageview</mat-icon>View Diff
		</button>
		<mat-divider></mat-divider>
	</ng-container>
</ng-container>
<ng-container
	*ngIf="
		editMode === true &&
		((hasChanges(element) && !element.deleted) || !hasChanges(element)) &&
		!element.autogenerated
	">
	<button
		mat-menu-item
		(click)="openAddElementDialog(element.id)"
		data-cy="element-insert-after-btn">
		<mat-icon color="success">add</mat-icon>Add array element after
	</button>
	<button
		mat-menu-item
		(click)="openAddElementDialog('start')"
		data-cy="element-insert-top-btn">
		<mat-icon color="success">add</mat-icon>Add array element at start
	</button>
	<button
		mat-menu-item
		(click)="openAddElementDialog()"
		data-cy="element-insert-end-btn">
		<mat-icon color="success">add</mat-icon>Add array element at end
	</button>
	<button
		mat-menu-item
		[matMenuTriggerFor]="copyMenu"
		[matMenuTriggerData]="{ copy: element }"
		data-cy="element-copy-btn">
		<mat-icon>content_copy</mat-icon>Copy
	</button>
	<mat-divider></mat-divider>
	<button
		mat-menu-item
		(click)="removeElement()"
		data-cy="element-remove-btn">
		<mat-icon color="warn">remove_circle_outline</mat-icon>Remove element
		from array
	</button>
	<button
		mat-menu-item
		(click)="deleteElement(element)">
		<mat-icon
			color="warn"
			data-cy="element-delete-btn"
			>delete_forever</mat-icon
		>Delete element globally
	</button>
</ng-container>
<ng-container *ngIf="element.autogenerated">
	<mat-label> No options available for autogenerated elements. </mat-label>
</ng-container>
<mat-menu #copyMenu>
	<ng-template
		matMenuContent
		let-copy="copy">
		<button
			mat-menu-item
			(click)="openAddElementDialog(element.id, copy)"
			data-cy="element-insert-after-btn">
			<mat-icon color="success">add</mat-icon>Add array element after
		</button>
		<button
			mat-menu-item
			(click)="openAddElementDialog('start', copy)"
			data-cy="element-insert-top-btn">
			<mat-icon color="success">add</mat-icon>Add array element at start
		</button>
		<button
			mat-menu-item
			(click)="openAddElementDialog(undefined, copy)"
			data-cy="element-insert-end-btn">
			<mat-icon color="success">add</mat-icon>Add array element at end
		</button>
	</ng-template>
</mat-menu>
