<!--
 * Copyright (c) 2021 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
<h1 mat-dialog-title>Add Sub Message to Message {{ data.name }}</h1>
<mat-horizontal-stepper
	#stepper
	class="new-submessage-stepper">
	<mat-step
		label="Select Sub Message options"
		#step1>
		<div class="form-container">
			<button
				mat-raised-button
				color="primary"
				matStepperNext
				(click)="createNew()"
				class="create-button"
				data-cy="create-new-btn">
				Create new Sub Message
			</button>
			<p style="width: 100%; text-align: center">or</p>
			<mat-form-field style="width: 100%">
				<mat-label>Select a Sub Message to Add to Message</mat-label>
				<mat-select
					[(ngModel)]="data.subMessage"
					(selectionChange)="storeId($event.value)">
					<osee-mat-option-loading
						[data]="availableSubMessages"
						objectName="SubMessages"
						paginationMode="AUTO"
						[paginationSize]="3">
						<ng-template let-option>
							<mat-option
								[value]="option"
								[id]="
									option !== undefined &&
									option.id !== undefined
										? option.id
										: ''
								">
								{{ option.name }}
							</mat-option>
						</ng-template>
					</osee-mat-option-loading>
				</mat-select>
			</mat-form-field>
		</div>
		<button
			mat-raised-button
			color="primary"
			*ngIf="data.subMessage?.id && data.subMessage?.id !== '-1'"
			(click)="moveToReview(stepper)">
			Proceed to Review
		</button>
	</mat-step>
	<mat-step
		label="Define Sub Message"
		#step2>
		<div style="display: flex; flex-direction: column">
			<mat-form-field>
				<mat-label>Name</mat-label>
				<input
					matInput
					[(ngModel)]="data.subMessage.name"
					required
					data-cy="field-name" />
			</mat-form-field>
			<mat-form-field>
				<mat-label>Description</mat-label>
				<textarea
					matInput
					cdkTextareaAutosize
					[(ngModel)]="data.subMessage.description"
					required
					data-cy="field-description"></textarea>
			</mat-form-field>
			<mat-form-field>
				<mat-label>Sub Message Number</mat-label>
				<input
					matInput
					type="number"
					[(ngModel)]="data.subMessage.interfaceSubMessageNumber"
					required
					data-cy="field-sub-message-number" />
			</mat-form-field>
		</div>
		<button
			mat-raised-button
			matStepperPrevious>
			Back
		</button>
		<button
			mat-raised-button
			color="primary"
			*ngIf="
				data.subMessage.name.length > 0 &&
				data.subMessage.description.length > 0 &&
				data.subMessage.interfaceSubMessageNumber !== undefined &&
				data.subMessage.interfaceSubMessageNumber !== ''
			"
			matStepperNext
			data-cy="stepper-next">
			Next
		</button>
	</mat-step>
	<mat-step
		label="Review"
		#step3>
		<div style="display: flex; flex-direction: column">
			A sub message will be related to:
			<mat-label>{{ data.name }}</mat-label> with the following
			properties:
			<mat-label>Sub Message Name: {{ data.subMessage.name }}</mat-label>
			<mat-label
				>Sub Message Description:
				{{ data.subMessage.description }}</mat-label
			>
			<mat-label
				>Sub Message Number:
				{{ data.subMessage.interfaceSubMessageNumber }}</mat-label
			>
		</div>
		<mat-dialog-actions align="end">
			<button
				mat-button
				matStepperPrevious
				data-cy="cancel-btn">
				Back
			</button>
			<button
				mat-raised-button
				color="primary"
				[mat-dialog-close]="data"
				data-cy="submit-btn">
				Ok
			</button>
		</mat-dialog-actions>
	</mat-step>
</mat-horizontal-stepper>
