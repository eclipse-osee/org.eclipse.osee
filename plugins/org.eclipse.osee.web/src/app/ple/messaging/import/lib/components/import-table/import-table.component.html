<!--
 * Copyright (c) 2023 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
<div class="table-container">
	<table
		mat-table
		[dataSource]="filteredData"
		class="mat-elevation-z1">
		<ng-container [matColumnDef]="'TableHeader'">
			<th
				mat-header-cell
				*matHeaderCellDef
				[attr.colspan]="headers.length"
				class="import-base-color">
				<div class="header-container">
					<div
						class="table-label"
						(click)="toggleTableContents()">
						<span>{{ tableTitle }}: {{ data.length }}</span>
					</div>
					<div class="import-table-filter">
						<mat-form-field
							class="import-table-filter-field"
							[ngClass]="
								showTableContents ? 'show-filter' : 'hide-table'
							">
							<mat-label
								>Filter
								{{ tableTitle.toLowerCase() }}</mat-label
							>
							<input
								matInput
								(keyup)="applyFilter($event)"
								#input />
							<mat-icon matPrefix>filter_list</mat-icon>
						</mat-form-field>
					</div>
				</div>
			</th>
		</ng-container>
		<ng-container
			[matColumnDef]="header"
			*ngFor="let header of headers">
			<th
				mat-header-cell
				*matHeaderCellDef
				class="import-table-header">
				{{
					(getTableHeaderByName(header) | async)?.humanReadable || ''
				}}
			</th>
			<td
				mat-cell
				*matCellDef="let item; let i = index">
				<ng-container *ngIf="header !== 'applicability'">
					<div
						oseeHighlightFilteredText
						[searchTerms]="filterText"
						[text]="item[header]"
						classToApply="import-table-highlighted-text">
						{{ item[header] }}
					</div>
				</ng-container>
				<ng-container *ngIf="header === 'applicability'">
					<div
						oseeHighlightFilteredText
						[searchTerms]="filterText"
						[text]="item[header].name"
						classToApply="import-table-highlighted-text">
						{{ item[header].name }}
					</div>
				</ng-container>
			</td>
		</ng-container>
		<tr
			mat-header-row
			*matHeaderRowDef="['TableHeader']; sticky: true"
			class="table-title-row"></tr>
		<tr
			mat-header-row
			*matHeaderRowDef="headers; sticky: true"
			[ngClass]="showTableContents ? 'show-table' : 'hide-table'"></tr>
		<tr
			mat-row
			*matRowDef="let row; columns: headers"
			[ngClass]="showTableContents ? 'show-table' : 'hide-table'"
			class="message-detail-row"></tr>
	</table>
</div>
