<!--
 * Copyright (c) 2023 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
<mat-expansion-panel
	[expanded]="panelOpen.value"
	class="[&>div>div]:tw-px-0"
	hideToggle>
	<mat-expansion-panel-header
		(click)="togglePanel()"
		[ngClass]="panelOpen.value ? 'tw-shadow-md' : ''"
		class="tw-px-0 hover:tw-bg-background-hover">
		<mat-panel-title class="tw-flex">
			<div class="tw-px-4">
				<mat-icon>
					{{ panelOpen.value ? 'expand_more' : 'chevron_right' }}
				</mat-icon>
			</div>
			<div class="tw-font-bold">Attributes Editor</div>
		</mat-panel-title>
	</mat-expansion-panel-header>

	<div class="tw-pt-4">
		<form
			#attributesEditorForm="ngForm"
			oseeForm>
			<div class="tw-flex tw-pb-4 tw-pl-4">
				<button
					class="tw-mr-auto"
					[disabled]="attributesEditorForm.invalid"
					(click)="saveChanges()">
					<mat-icon
						[ngClass]="[
							attributesEditorForm.invalid
								? 'tw-text-warning'
								: '',
							hasChanges() ? 'tw-text-primary' : ''
						]"
						>save</mat-icon
					>
				</button>
			</div>

			@if (attributesEditorForm.invalid) {
				<div class="tw-pb-4 tw-italic tw-text-warning">
					*Required fields not filled out
				</div>
			}

			<osee-attributes-editor
				[attributes]="tab.artifact.attributes"
				[editable]="tab.artifact.editable"
				(updatedAttributes)="handleUpdatedAttributes($event)" />
		</form>
	</div>
</mat-expansion-panel>
