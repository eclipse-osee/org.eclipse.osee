<!--
 * Copyright (c) 2023 Boeing
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Boeing - initial API and implementation
 -->
@if (tabs().length === 0) {
	<div
		class="tw-flex tw-h-[80%] tw-w-full tw-items-center tw-justify-center tw-opacity-70">
		<span
			class="tw-select-none tw-text-4xl tw-font-bold tw-text-background-status-bar"
			>No open tabs</span
		>
	</div>
} @else {
	<mat-tab-group
		[animationDuration]="0"
		[selectedIndex]="selectedIndex()"
		(selectedIndexChange)="selectIndex($event)"
		mat-stretch-tabs="false"
		mat-align-tabs="start"
		fitInkBarToContent>
		@for (tab of tabs(); track $index) {
			<mat-tab #matTab>
				<ng-template mat-tab-label>
					<div
						(cdkDropListDropped)="onTabDropped($event)"
						[cdkDropListConnectedTo]="
							getAllDropListConnections($index)()
						"
						cdkDropListOrientation="horizontal"
						cdkDropList
						[id]="'' + $index">
						<div
							class="tw-flex tw-items-center tw-rounded-t-md"
							cdkDrag>
							<mat-icon>{{ getTabIcon(tab) }}</mat-icon>
							<div class="tw-pl-4">
								{{ tab.tabTitle }}
							</div>
							<button
								mat-icon-button
								(click)="removeTab($index)">
								<mat-icon>clear</mat-icon>
							</button>
						</div>
					</div>
				</ng-template>

				@switch (tab.tabType) {
					@case ('Artifact') {
						<osee-artifact-editor [tab]="tab" />
					}
					@case ('ChangeReport') {
						<osee-change-report-table
							[branchId]="
								tab.branchId
							"></osee-change-report-table>
					}
					@default {
						No tab defined for this type
					}
				}
			</mat-tab>
		}
	</mat-tab-group>
}
